<div align="center">
  <br/>
  <br/>
  <img src="./logo.svg" width="100" alt="NodeJS Logo">
  <br/>
  <br/>
  <p>ä¸€ä¸ªç®€å•çš„ NodeJS + TS æ¥å£æœåŠ¡é¡¹ç›®æ¨¡æ¿</p>
</div>

<h1 align="center">NodeJS æ¥å£æœåŠ¡é¡¹ç›®æ¨¡æ¿</h1>

## ğŸ“š ç›®å½•

- [ğŸ“š ç›®å½•](#-ç›®å½•)
- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
  - [å®‰è£…](#å®‰è£…)
  - [é…ç½®](#é…ç½®)
  - [å¯åŠ¨æœåŠ¡](#å¯åŠ¨æœåŠ¡)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
  - [é¡¹ç›®é…ç½®](#é¡¹ç›®é…ç½®)
  - [æ•°æ®åº“é…ç½®](#æ•°æ®åº“é…ç½®)
  - [æ—¥å¿—é…ç½®](#æ—¥å¿—é…ç½®)
  - [API è·¯ç”±å¼€å‘](#api-è·¯ç”±å¼€å‘)
  - [ä¸­é—´ä»¶ä½¿ç”¨](#ä¸­é—´ä»¶ä½¿ç”¨)
  - [æ¨¡å‹å®šä¹‰](#æ¨¡å‹å®šä¹‰)
  - [å·¥å…·ç±»ä½¿ç”¨](#å·¥å…·ç±»ä½¿ç”¨)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
  - [å¼€å‘ç¯å¢ƒ](#å¼€å‘ç¯å¢ƒ)
  - [æµ‹è¯•ç¯å¢ƒ](#æµ‹è¯•ç¯å¢ƒ)
  - [ç”Ÿäº§ç¯å¢ƒ](#ç”Ÿäº§ç¯å¢ƒ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
  - [æ•°æ®åº“è¿æ¥å¤±è´¥](#æ•°æ®åº“è¿æ¥å¤±è´¥)
  - [API æ–‡æ¡£ç”Ÿæˆå¤±è´¥](#api-æ–‡æ¡£ç”Ÿæˆå¤±è´¥)
  - [å¯åŠ¨æœåŠ¡å¤±è´¥](#å¯åŠ¨æœåŠ¡å¤±è´¥)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [è®¸å¯è¯](#è®¸å¯è¯)
- [ä½œè€…](#ä½œè€…)

## é¡¹ç›®ç®€ä»‹

NodeJS Server Template æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ Node.js æœåŠ¡å™¨é¡¹ç›®æ¨¡æ¿ï¼ŒåŸºäº Express æ¡†æ¶å’Œ TypeScript å¼€å‘ã€‚è¯¥æ¨¡æ¿æä¾›äº†ä¸€å¥—å®Œæ•´çš„åç«¯æœåŠ¡æ¶æ„ï¼ŒåŒ…æ‹¬ API è·¯ç”±ã€æ•°æ®åº“é›†æˆã€ç”¨æˆ·è®¤è¯ã€æ—¥å¿—è®°å½•ã€é”™è¯¯å¤„ç†ç­‰åŠŸèƒ½ã€‚é€‚ç”¨äºå¿«é€Ÿæ­å»º RESTful API æœåŠ¡ã€Web åº”ç”¨åç«¯ä»¥åŠå„ç±»ä¸­å°å‹æœåŠ¡ç«¯é¡¹ç›®ã€‚

æœ¬æ¨¡æ¿æ—¨åœ¨æä¾›ä¸€ä¸ªè§„èŒƒã€å¯æ‰©å±•çš„é¡¹ç›®ç»“æ„ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿè¿›å…¥ä¸šåŠ¡å¼€å‘é˜¶æ®µï¼Œæ— éœ€èŠ±è´¹å¤§é‡æ—¶é—´åœ¨é¡¹ç›®æ¡†æ¶æ­å»ºä¸Šã€‚åŒæ—¶ï¼Œæ¨¡æ¿é›†æˆäº†å½“å‰æµè¡Œçš„æŠ€æœ¯æ ˆå’Œæœ€ä½³å®è·µï¼Œç¡®ä¿å¼€å‘å‡ºçš„åº”ç”¨å…·æœ‰è‰¯å¥½çš„æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **å®Œæ•´çš„ TypeScript æ”¯æŒ**ï¼šæä¾›äº†ç±»å‹å®‰å…¨å’Œé«˜æ•ˆçš„å¼€å‘ä½“éªŒ
- âœ… **Express æ¡†æ¶**ï¼šåŸºäºæˆç†Ÿç¨³å®šçš„ Web æœåŠ¡æ¡†æ¶
- âœ… **MySQL æ•°æ®åº“é›†æˆ**ï¼šä½¿ç”¨ Sequelize ORM è¿›è¡Œæ•°æ®åº“æ“ä½œ
- âœ… **RESTful API**ï¼šæ ‡å‡†åŒ–çš„ API è®¾è®¡å’Œå®ç°
- âœ… **API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ**ï¼šä½¿ç”¨ apiDoc è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- âœ… **ç”¨æˆ·è®¤è¯**ï¼šé›†æˆ JWT è®¤è¯æœºåˆ¶
- âœ… **æ—¥å¿—ç³»ç»Ÿ**ï¼šä½¿ç”¨ log4js è¿›è¡Œæ—¥å¿—è®°å½•
- âœ… **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œå¤„ç†
- âœ… **è·¨åŸŸæ”¯æŒ**ï¼šå†…ç½® CORS ä¸­é—´ä»¶
- âœ… **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- âœ… **ç¯å¢ƒé…ç½®**ï¼šåŸºäº dotenv çš„ç¯å¢ƒé…ç½®
- âœ… **IP åœ°å€è§£æ**ï¼šé›†æˆ ip2region è¿›è¡Œ IP åœ°å€æŸ¥è¯¢
- âœ… **åŠ å¯†å·¥å…·**ï¼šæä¾›å¸¸ç”¨çš„åŠ å¯†è§£å¯†åŠŸèƒ½
- âœ… **çƒ­é‡è½½**ï¼šå¼€å‘æ¨¡å¼ä¸‹æ”¯æŒçƒ­é‡è½½

## æŠ€æœ¯æ ˆ

- **è¿è¡Œç¯å¢ƒ**ï¼šNode.js (>=16.20.2)
- **å¼€å‘è¯­è¨€**ï¼šTypeScript
- **Web æ¡†æ¶**ï¼šExpress
- **ORM æ¡†æ¶**ï¼šSequelize
- **æ•°æ®åº“**ï¼šMySQL
- **æ—¥å¿—å·¥å…·**ï¼šlog4js, morgan
- **æ–‡æ¡£å·¥å…·**ï¼šapiDoc
- **è®¤è¯æœºåˆ¶**ï¼šJWT (jsonwebtoken)
- **å…¶ä»–å·¥å…·**ï¼š
  - cors (è·¨åŸŸ)
  - multer (æ–‡ä»¶ä¸Šä¼ )
  - dotenv (ç¯å¢ƒå˜é‡)
  - ip2region (IP åœ°å€è§£æ)
  - webp-converter (WebP å›¾ç‰‡è½¬æ¢)

## é¡¹ç›®ç»“æ„

```
nodejs-server-template/
â”œâ”€â”€ apidoc/                # APIæ–‡æ¡£ç”Ÿæˆç›®å½•
â”œâ”€â”€ config/                # é¡¹ç›®é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ db.config.ts       # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ log4js.config.ts   # æ—¥å¿—é…ç½®
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ node_modules/          # ä¾èµ–åŒ…
â”œâ”€â”€ public/                # é™æ€èµ„æºç›®å½•
â”œâ”€â”€ src/                   # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ express/           # Expressåº”ç”¨é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts       # Expresså®ä¾‹å’Œä¸­é—´ä»¶é…ç½®
â”‚   â”œâ”€â”€ middleware/        # è‡ªå®šä¹‰ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ morgan.ts      # Morganæ—¥å¿—ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ init.ts        # æ¨¡å‹åˆå§‹åŒ–
â”‚   â”‚   â””â”€â”€ index.ts       # Sequelizeé…ç½®
â”‚   â”œâ”€â”€ router/            # è·¯ç”±ç›®å½•
â”‚   â”‚   â””â”€â”€ api/           # APIè·¯ç”±
â”‚   â”‚       â”œâ”€â”€ user/      # ç”¨æˆ·ç›¸å…³API
â”‚   â”‚       â”‚   â”œâ”€â”€ handler/  # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚       â”‚   â””â”€â”€ index.ts  # ç”¨æˆ·è·¯ç”±å®šä¹‰
â”‚   â”‚       â””â”€â”€ index.ts   # APIè·¯ç”±å…¥å£
â”‚   â””â”€â”€ utils/             # å·¥å…·ç±»
â”‚       â”œâ”€â”€ u.crypto.ts    # åŠ å¯†è§£å¯†å·¥å…·
â”‚       â”œâ”€â”€ u.file.ts      # æ–‡ä»¶å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ u.ip2region.ts # IPè§£æå·¥å…·
â”‚       â”œâ”€â”€ u.logger.ts    # æ—¥å¿—å·¥å…·
â”‚       â””â”€â”€ u.sendResult.ts # å“åº”ç»“æœå·¥å…·
â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ .gitignore             # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .nvmrc                 # Nodeç‰ˆæœ¬é…ç½®
â”œâ”€â”€ apidoc.json            # APIæ–‡æ¡£é…ç½®
â”œâ”€â”€ check-node-version.js  # Nodeç‰ˆæœ¬æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ env.d.ts               # ç¯å¢ƒå˜é‡ç±»å‹å®šä¹‰
â”œâ”€â”€ index.ts               # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
â”œâ”€â”€ package-lock.json      # ä¾èµ–ç‰ˆæœ¬é”å®š
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ tsconfig.json          # TypeScripté…ç½®
```

## ç¯å¢ƒè¦æ±‚

- Node.js >= 16.20.2
- npm æˆ– yarn
- MySQL æ•°æ®åº“

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

1. å…‹éš†ä»“åº“åˆ°æœ¬åœ°ï¼š

```bash
git clone https://gitee.com/lanyun417/odeservertemplate.git
cd nodejs-server-template
```

2. å®‰è£…ä¾èµ–ï¼š

```bash
npm install
# æˆ–ä½¿ç”¨ yarn
yarn install
```

å¦‚æœæ‚¨çš„ Node.js ç‰ˆæœ¬ä½äº 16.20.2ï¼Œå®‰è£…è¿‡ç¨‹ä¸­ä¼šæç¤ºé”™è¯¯ã€‚è¯·ä½¿ç”¨ NVM æˆ–å…¶ä»–å·¥å…·å‡çº§ Node.js ç‰ˆæœ¬ã€‚

### é…ç½®

1. ç¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶`.env.example`æ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æˆ–åˆ›å»ºä¸€ä¸ªæ–°çš„`.env`æ–‡ä»¶ï¼Œæ ¹æ®æ‚¨çš„ç¯å¢ƒè¿›è¡Œé…ç½®ï¼š

```bash
# æ¥å£è¿è¡Œç«¯å£
SERVER_PORT=3000

# æ¥å£åŸŸå || åœ°å€
SERVER_HOST=http://localhost:3000

# Token å¯†é’¥
TOKEN_SECRET=your_secret_key
```

2. æ•°æ®åº“é…ç½®

ä¿®æ”¹`config/db.config.ts`æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```typescript
export const dbConfig: DatabaseConfig = {
	host: 'localhost', // æ•°æ®åº“åœ°å€
	user: 'root', // æ•°æ®åº“ç”¨æˆ·å
	database: 'your_db', // æ•°æ®åº“åç§°
	password: 'your_password', // æ•°æ®åº“å¯†ç 
	dialect: 'mysql', // æ•°æ®åº“ç±»å‹
	pool: {
		// è¿æ¥æ± é…ç½®
		max: 10, // æœ€å¤§è¿æ¥æ•°
		min: 1, // æœ€å°è¿æ¥æ•°
		acquire: 30000, // æœ€å¤§è¿æ¥æ—¶é—´
		idle: 10000, // ç©ºé—²è¿æ¥å›æ”¶æ—¶é—´
	},
	timezone: '+08:00', // ä¸œå…«æ—¶åŒº
};
```

ç¡®ä¿å·²åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“ï¼Œæˆ–åœ¨é¦–æ¬¡è¿è¡Œæ—¶å…è®¸ Sequelize è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€‚

### å¯åŠ¨æœåŠ¡

1. å¼€å‘æ¨¡å¼å¯åŠ¨ï¼ˆå¸¦çƒ­é‡è½½ï¼‰ï¼š

```bash
npm run dev
# æˆ–ä½¿ç”¨ yarn
yarn dev
```

2. ç”Ÿäº§æ¨¡å¼å¯åŠ¨ï¼š

```bash
npm start
# æˆ–ä½¿ç”¨ yarn
yarn start
```

3. ç”Ÿæˆ API æ–‡æ¡£ï¼š

```bash
npm run doc
# æˆ–ä½¿ç”¨ yarn
yarn doc
```

å¯åŠ¨æˆåŠŸåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®æœåŠ¡ï¼š

- API æœåŠ¡ï¼šhttp://localhost:3000/api
- API æ–‡æ¡£ï¼šhttp://localhost:3000/apiDoc

## å¼€å‘æŒ‡å—

### é¡¹ç›®é…ç½®

é¡¹ç›®çš„ä¸»è¦é…ç½®æ–‡ä»¶åŒ…æ‹¬ï¼š

1. `.env`ï¼šç¯å¢ƒå˜é‡é…ç½®
2. `config/db.config.ts`ï¼šæ•°æ®åº“é…ç½®
3. `config/log4js.config.ts`ï¼šæ—¥å¿—é…ç½®
4. `tsconfig.json`ï¼šTypeScript é…ç½®
5. `apidoc.json`ï¼šAPI æ–‡æ¡£é…ç½®

### æ•°æ®åº“é…ç½®

æ•°æ®åº“é…ç½®ä½äº`config/db.config.ts`æ–‡ä»¶ä¸­ï¼Œæ”¯æŒ MySQL æ•°æ®åº“ã€‚é€šè¿‡ä¿®æ”¹è¯¥æ–‡ä»¶å¯ä»¥é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯å’Œè¿æ¥æ± å‚æ•°ã€‚Sequelize å®ä¾‹çš„åˆ›å»ºä½äº`src/models/index.ts`æ–‡ä»¶ä¸­ã€‚

```typescript
import { Sequelize } from 'sequelize';
import { dbLog } from '@/utils/u.logger';
import { dbConfig } from 'config/db.config';

// æ•°æ®åº“è¿æ¥é…ç½®
const { host, user, password, database, dialect, pool, timezone } = dbConfig;

// åˆ›å»º Sequelize å®ä¾‹
const sequelize: Sequelize = new Sequelize(database, user, password, {
	host,
	pool,
	dialect,
	timezone,
	logging: (log: string): void => dbLog(log),
});

export default sequelize;
```

### æ—¥å¿—é…ç½®

æ—¥å¿—é…ç½®ä½äº`config/log4js.config.ts`æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ log4js åº“è¿›è¡Œæ—¥å¿—è®°å½•ã€‚æ—¥å¿—æ–‡ä»¶å­˜å‚¨åœ¨`logs`ç›®å½•ä¸‹ï¼ŒæŒ‰ç…§ä¸åŒçš„æ—¥å¿—çº§åˆ«å’Œç”¨é€”åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ã€‚

æ—¥å¿—å·¥å…·å°è£…åœ¨`src/utils/u.logger.ts`æ–‡ä»¶ä¸­ï¼Œæä¾›äº†ä¸åŒçº§åˆ«çš„æ—¥å¿—è®°å½•å‡½æ•°ï¼š

```typescript
import log4js from 'log4js';

// å¯¼å…¥æ—¥å¿—é…ç½®
log4js.configure(/* é…ç½® */);

// è·å–ä¸åŒç±»å‹çš„æ—¥å¿—è®°å½•å™¨
const logConsole = log4js.getLogger('console');
const logDebug = log4js.getLogger('debug');
const logError = log4js.getLogger('error');
const logDatabase = log4js.getLogger('database');

// å¯¼å‡ºæ—¥å¿—å‡½æ•°
export const console = (message: any): void => logConsole.info(message);
export const debug = (message: any): void => logDebug.debug(message);
export const error = (message: any): void => logError.error(message);
export const dbLog = (message: any): void => logDatabase.info(message);
```

### API è·¯ç”±å¼€å‘

API è·¯ç”±é‡‡ç”¨æ¨¡å—åŒ–ç»„ç»‡ï¼Œä½äº`src/router/api`ç›®å½•ä¸‹ã€‚æ¯ä¸ªåŠŸèƒ½æ¨¡å—æœ‰è‡ªå·±çš„è·¯ç”±æ–‡ä»¶å’Œå¤„ç†å™¨ã€‚

ä¾‹å¦‚ï¼Œç”¨æˆ·æ¨¡å—çš„è·¯ç”±å®šä¹‰åœ¨`src/router/api/user/index.ts`æ–‡ä»¶ä¸­ï¼š

```typescript
import express from 'express';
import { Router } from 'express';
import { userHandle } from './handler/user.handle';

const router: Router = express.Router();

/**
 * @api {get} /user/getUser è¯·æ±‚ç”¨æˆ·ä¿¡æ¯
 * @apiName è¯·æ±‚ç”¨æˆ·ä¿¡æ¯
 * @apiGroup ç”¨æˆ·
 *
 * @apiSampleRequest /user/getUser
 *
 * @apiSuccess {Number} code å“åº”çŠ¶æ€ç 
 * @apiSuccess {String} message å“åº”æ¶ˆæ¯
 * @apiSuccess {String} username ç”¨æˆ·å
 * @apiSuccess {String} password å¯†ç 
 *
 * @apiSuccessExample Success-Response:
 *     HTTP/1.1 200 OK
 *     {
 *       "username": "lanyun",
 *       "password": "123456"
 *     }
 */
router.get('/getUser', userHandle);

export default router;
```

æ·»åŠ æ–°çš„ API è·¯ç”±éœ€è¦ï¼š

1. åœ¨å¯¹åº”çš„æ¨¡å—ç›®å½•ä¸‹åˆ›å»ºè·¯ç”±æ–‡ä»¶
2. åœ¨è·¯ç”±æ–‡ä»¶ä¸­å®šä¹‰ API è·¯ç”±å’Œå¤„ç†å‡½æ•°
3. åœ¨ä¸Šçº§è·¯ç”±æ–‡ä»¶ä¸­å¼•å…¥å¹¶æ³¨å†Œæ–°è·¯ç”±

### ä¸­é—´ä»¶ä½¿ç”¨

ä¸­é—´ä»¶é…ç½®ä½äº`src/express/index.ts`æ–‡ä»¶ä¸­ï¼Œå·²ç»é…ç½®äº†å¸¸ç”¨çš„ä¸­é—´ä»¶ï¼š

```typescript
import cors from 'cors';
import cookieParser from 'cookie-parser';
import { error } from '@/utils/u.logger';
import apiRouter from '@/router/api/index';
import { morganMiddleware } from '@/middleware/morgan';
import express, { Request, Response, NextFunction } from 'express';

const app = express();

app.use(cors());
app.use(cookieParser());
app.use(express.json());
app.use(morganMiddleware());
app.use(express.static('public'));
app.use(express.urlencoded({ extended: true }));

// Router
app.use('/api', apiRouter);
app.use('/apiDoc', express.static('apidoc'));
app.use('/static', express.static('upload'));

// Express ç»Ÿä¸€é”™è¯¯å¤„ç†
app.use((err: any, req: Request, res: Response, next: NextFunction) => {
	res.status(500).json({ message: err.message });
	error(err);
});

export const exp = app;
```

æ·»åŠ è‡ªå®šä¹‰ä¸­é—´ä»¶å¯ä»¥ï¼š

1. åœ¨`src/middleware`ç›®å½•ä¸‹åˆ›å»ºä¸­é—´ä»¶æ–‡ä»¶
2. åœ¨`src/express/index.ts`æ–‡ä»¶ä¸­å¼•å…¥å¹¶ä½¿ç”¨ä¸­é—´ä»¶

### æ¨¡å‹å®šä¹‰

æ•°æ®æ¨¡å‹å®šä¹‰ä½äº`src/models`ç›®å½•ä¸‹ï¼Œä½¿ç”¨ Sequelize ORM è¿›è¡Œå®šä¹‰ã€‚æ¨¡å‹æ–‡ä»¶åº”éµå¾ªå‘½åçº¦å®šï¼š`m.å®ä½“åç§°.ts`ã€‚

æ·»åŠ æ–°çš„æ•°æ®æ¨¡å‹ï¼š

1. åœ¨`src/models`ç›®å½•ä¸‹åˆ›å»ºæ¨¡å‹æ–‡ä»¶
2. åœ¨æ¨¡å‹æ–‡ä»¶ä¸­å®šä¹‰æ•°æ®æ¨¡å‹å’Œå…³è”å…³ç³»
3. åœ¨`src/models/init.ts`æ–‡ä»¶ä¸­å¼•å…¥æ¨¡å‹

### å·¥å…·ç±»ä½¿ç”¨

é¡¹ç›®æä¾›äº†å¤šä¸ªå·¥å…·ç±»ï¼Œä½äº`src/utils`ç›®å½•ä¸‹ï¼š

- `u.crypto.ts`ï¼šåŠ å¯†è§£å¯†å·¥å…·
- `u.file.ts`ï¼šæ–‡ä»¶å¤„ç†å·¥å…·
- `u.ip2region.ts`ï¼šIP è§£æå·¥å…·
- `u.logger.ts`ï¼šæ—¥å¿—å·¥å…·
- `u.sendResult.ts`ï¼šå“åº”ç»“æœå·¥å…·

ä½¿ç”¨å·¥å…·ç±»åªéœ€å¯¼å…¥å¯¹åº”çš„å‡½æ•°å³å¯ï¼š

```typescript
import { encrypt, decrypt } from '@/utils/u.crypto';
import { success, fail } from '@/utils/u.sendResult';
```

## API æ–‡æ¡£

é¡¹ç›®ä½¿ç”¨ apiDoc è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ã€‚åœ¨ API è·¯ç”±å®šä¹‰ä¸­æ·»åŠ  apiDoc æ³¨é‡Šï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆæ–‡æ¡£ï¼š

```bash
npm run doc
```

ç”Ÿæˆçš„æ–‡æ¡£ä½äº`apidoc`ç›®å½•ä¸‹ï¼Œå¯ä»¥é€šè¿‡`http://localhost:3000/apiDoc`è®¿é—®ã€‚

apiDoc æ³¨é‡Šç¤ºä¾‹ï¼š

```typescript
/**
 * @api {get} /user/getUser è¯·æ±‚ç”¨æˆ·ä¿¡æ¯
 * @apiName è¯·æ±‚ç”¨æˆ·ä¿¡æ¯
 * @apiGroup ç”¨æˆ·
 *
 * @apiSampleRequest /user/getUser
 *
 * @apiSuccess {Number} code å“åº”çŠ¶æ€ç 
 * @apiSuccess {String} message å“åº”æ¶ˆæ¯
 * @apiSuccess {String} username ç”¨æˆ·å
 * @apiSuccess {String} password å¯†ç 
 *
 * @apiSuccessExample Success-Response:
 *     HTTP/1.1 200 OK
 *     {
 *       "username": "lanyun",
 *       "password": "123456"
 *     }
 */
```

## éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ

å¼€å‘ç¯å¢ƒå»ºè®®ä½¿ç”¨`npm run dev`å‘½ä»¤å¯åŠ¨ï¼Œæ”¯æŒçƒ­é‡è½½ï¼Œä¾¿äºå¼€å‘è°ƒè¯•ã€‚

### æµ‹è¯•ç¯å¢ƒ

æµ‹è¯•ç¯å¢ƒå¯ä»¥ä½¿ç”¨ PM2 è¿›è¡Œè¿›ç¨‹ç®¡ç†ï¼š

1. å®‰è£… PM2ï¼š

```bash
npm install -g pm2
```

2. åˆ›å»º PM2 é…ç½®æ–‡ä»¶`ecosystem.config.js`ï¼š

```javascript
module.exports = {
	apps: [
		{
			name: 'nodejs-server-template-test',
			script: 'npm',
			args: 'start',
			env: {
				NODE_ENV: 'test',
			},
		},
	],
};
```

3. å¯åŠ¨æœåŠ¡ï¼š

```bash
pm2 start ecosystem.config.js
```

### ç”Ÿäº§ç¯å¢ƒ

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ­¥éª¤ï¼š

1. æ„å»ºé¡¹ç›®ï¼ˆå¦‚éœ€ç¼–è¯‘ï¼‰
2. é…ç½®ç¯å¢ƒå˜é‡
3. ä½¿ç”¨ PM2 æˆ–å…¶ä»–è¿›ç¨‹ç®¡ç†å·¥å…·å¯åŠ¨æœåŠ¡

PM2 ç”Ÿäº§ç¯å¢ƒé…ç½®ç¤ºä¾‹ï¼š

```javascript
module.exports = {
	apps: [
		{
			name: 'nodejs-server-template-prod',
			script: 'npm',
			args: 'start',
			env: {
				NODE_ENV: 'production',
			},
			instances: 'max',
			exec_mode: 'cluster',
		},
	],
};
```

## å¸¸è§é—®é¢˜

### æ•°æ®åº“è¿æ¥å¤±è´¥

- æ£€æŸ¥æ•°æ®åº“é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®ä¿æ•°æ®åº“æœåŠ¡å·²å¯åŠ¨
- éªŒè¯æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç 

### API æ–‡æ¡£ç”Ÿæˆå¤±è´¥

- ç¡®ä¿ apiDoc å·²æ­£ç¡®å®‰è£…
- æ£€æŸ¥ apiDoc æ³¨é‡Šæ ¼å¼æ˜¯å¦æ­£ç¡®
- éªŒè¯ apidoc.json é…ç½®æ˜¯å¦æœ‰æ•ˆ

### å¯åŠ¨æœåŠ¡å¤±è´¥

- æ£€æŸ¥ Node.js ç‰ˆæœ¬æ˜¯å¦æ»¡è¶³è¦æ±‚
- ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²å®‰è£…
- éªŒè¯ç«¯å£æ˜¯å¦è¢«å ç”¨

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç æˆ–æå‡ºå»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. æäº¤ Pull Request

## è®¸å¯è¯

ISC

## ä½œè€…

LanYun

---

_æœ¬é¡¹ç›®æ¨¡æ¿ç”± LanYun å¼€å‘å’Œç»´æŠ¤ã€‚_
#   n o d e j s - s e r v e r - t e m p l a t e  
 